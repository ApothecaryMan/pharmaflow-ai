@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@100;200;300;400;500;600;700&display=swap');
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Define structural variables for Recharts/SVG usage */
:root {
  --border-color: #e5e7eb; /* gray-200 */
  --text-secondary: #6b7280; /* gray-500 */
  --font-en: "Inter";
  --font-ar: "Cairo";
}

.dark {
  --border-color: #374151; /* gray-700 */
  --text-secondary: #9ca3af; /* gray-400 */
}

/* PWA Styles - iOS/iPad Safe Areas & Standalone Mode */
@supports (padding: env(safe-area-inset-top)) {
  body {
    /* Handle notch/home indicator safe areas */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

/* Prevent iOS rubber-band scrolling on the body */
html,
body {
  overscroll-behavior: none;
  -webkit-overflow-scrolling: touch;
}

/* PWA Standalone Mode Detection */
@media (display-mode: standalone) {
  /* Add any standalone-specific styles here */
  body {
    /* Slightly different styling when running as PWA */
  }
}



/* Prevent text selection on UI elements (PWA feel) */
.no-select {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

@layer utilities {
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: theme('colors.gray.300') transparent;
  }
  .dark .custom-scrollbar {
    scrollbar-color: theme('colors.gray.700') transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    @apply bg-gray-300 dark:bg-gray-700;
    border-radius: 20px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    @apply bg-gray-400 dark:bg-gray-600;
  }

  .custom-scrollbar::-webkit-scrollbar-button {
  display: none;
  }
}

/* --- Real-Time Sales Animations --- */
@keyframes slideIn {
  0% {
    opacity: 0;
    transform: perspective(1000px) rotateX(-10deg) translateY(-20px) scale(0.95);
    background-color: rgba(16, 185, 129, 0.4);
    box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.2);
  }
  60% {
    transform: perspective(1000px) rotateX(2deg) translateY(4px) scale(1.01);
  }
  80% {
    transform: perspective(1000px) rotateX(0deg) translateY(-1px) scale(0.99);
  }
  100% {
    opacity: 1;
    transform: perspective(1000px) rotateX(0) translateY(0) scale(1);
    background-color: transparent;
    box-shadow: none;
  }
}

.new-transaction {
  animation: slideIn 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  will-change: transform, opacity, background-color;
  position: relative;
  z-index: 10;
}

/* YouTube-style Roll Up Animation for Order ID */
@keyframes rollUp {
  0% {
    transform: translateY(100%);
    opacity: 0;
  }
  30% {
    opacity: 1;
  }
  100% {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes pulse-green {
  0%,
  100% {
    color: inherit;
  }
  50% {
    color: #22c55e;
  }
}

/* Custom Card Shadow (User Request 2025-12-09) */
/* Light Mode Only Override */
html:not(.dark) .card-shadow {
  box-shadow: none !important;
  border: 2px solid #e5e7eb !important;
}

/* --- Google Sans Flex Variable Typography System --- */
:root {
  /* Core Axes Defaults */
  --font-weight: 400; /* wght: 100-1000 */
  --font-width: 100; /* wdth: 50-150 (approx, standard is 100) */
  --font-grade: 0; /* GRAD: -200 to 150 */

  /* Semantic Weight Tokens */
  --weight-calm: 350; /* Lighter, airy */
  --weight-functional: 400; /* Standard, readable */
  --weight-medium: 500; /* Structured */
  --weight-bold: 650; /* Emphatic but not heavy */

  /* Semantic Width Tokens */
  --width-compact: 95; /* Efficient for data */
  --width-standard: 100; /* Normal reading */
  --width-expressive: 110; /* Wider for headlines/hero */

  /* Semantic Grade Tokens */
  --grade-soft: -25;
  --grade-neutral: 0;
  --grade-strong: 20;

  /* Slant Axis */
  --font-slant: 0;

  /* Advanced Axes (Google Sans Flex) */
  --font-xtra: 468; /* Parametric Grade (Thickness) 323..603 */
  --font-yopq: 79;  /* Thin Stroke 25..135 */
  --font-ytas: 750; /* Ascender Height 649..854 */
  --font-ytde: -203; /* Descender Depth 98..305 (Using standard negative mapping or positive per font spec) */
  --font-ytfi: 738; /* Figure Height 560..788 */
  --font-ytlc: 514; /* Lowercase Height 416..570 */
  --font-ytuc: 712; /* Uppercase Height 528..760 */
}

/* Dark Mode Typography Optimization */
/* Thins the font slightly (-25 grade) to counter the "irradiation illusion" where white text looks thicker */
.dark body {
  --grade-neutral: -25;
  --font-grade: -25;
}

/* --- IBM Plex Sans Arabic (Restricted to Arabic Range) --- */
/* We inline this to force unicode-range, ensuring English NEVER uses this font */
@font-face {
  font-family: "IBM Plex Sans Arabic";
  font-style: normal;
  font-weight: 100;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/ibmplexsansarabic/v14/Qw3MZRtWPQCuHme67tEYUIx3Kh0PHR9N6YNe3PA.ttf)
    format("truetype");
  unicode-range: U+0600-06FF, U+0750-077F, U+08A0-08FF, U+FB50-FDFF, U+FE70-FEFF;
}
@font-face {
  font-family: "IBM Plex Sans Arabic";
  font-style: normal;
  font-weight: 200;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/ibmplexsansarabic/v14/Qw3NZRtWPQCuHme67tEYUIx3Kh0PHR9N6YPy_dCT.ttf)
    format("truetype");
  unicode-range: U+0600-06FF, U+0750-077F, U+08A0-08FF, U+FB50-FDFF, U+FE70-FEFF;
}
@font-face {
  font-family: "IBM Plex Sans Arabic";
  font-style: normal;
  font-weight: 300;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/ibmplexsansarabic/v14/Qw3NZRtWPQCuHme67tEYUIx3Kh0PHR9N6YOW_tCT.ttf)
    format("truetype");
  unicode-range: U+0600-06FF, U+0750-077F, U+08A0-08FF, U+FB50-FDFF, U+FE70-FEFF;
}
@font-face {
  font-family: "IBM Plex Sans Arabic";
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/ibmplexsansarabic/v14/Qw3CZRtWPQCuHme67tEYUIx3Kh0PHR9N6bs6.ttf)
    format("truetype");
  unicode-range: U+0600-06FF, U+0750-077F, U+08A0-08FF, U+FB50-FDFF, U+FE70-FEFF;
}
@font-face {
  font-family: "IBM Plex Sans Arabic";
  font-style: normal;
  font-weight: 500;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/ibmplexsansarabic/v14/Qw3NZRtWPQCuHme67tEYUIx3Kh0PHR9N6YPO_9CT.ttf)
    format("truetype");
  unicode-range: U+0600-06FF, U+0750-077F, U+08A0-08FF, U+FB50-FDFF, U+FE70-FEFF;
}
@font-face {
  font-family: "IBM Plex Sans Arabic";
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/ibmplexsansarabic/v14/Qw3NZRtWPQCuHme67tEYUIx3Kh0PHR9N6YPi-NCT.ttf)
    format("truetype");
  unicode-range: U+0600-06FF, U+0750-077F, U+08A0-08FF, U+FB50-FDFF, U+FE70-FEFF;
}
@font-face {
  font-family: "IBM Plex Sans Arabic";
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/ibmplexsansarabic/v14/Qw3NZRtWPQCuHme67tEYUIx3Kh0PHR9N6YOG-dCT.ttf)
    format("truetype");
  unicode-range: U+0600-06FF, U+0750-077F, U+08A0-08FF, U+FB50-FDFF, U+FE70-FEFF;
}

/* Global Typography Reset */
body {
  font-family: var(--font-en), var(--font-ar), -apple-system, BlinkMacSystemFont, "Google Sans Flex", sans-serif;

  /* Enable Native Browser Optical Sizing */
  font-optical-sizing: auto;

  /* Bind Axes to Variables */
  font-variation-settings: "wght" var(--font-weight), "wdth" var(--font-width),
    "GRAD" var(--font-grade), "slnt" var(--font-slant),
    "XTRA" var(--font-xtra), "YOPQ" var(--font-yopq),
    "YTAS" var(--font-ytas), "YTDE" var(--font-ytde),
    "YTFI" var(--font-ytfi), "YTLC" var(--font-ytlc),
    "YTUC" var(--font-ytuc);

  /* Smooth "Breathe" Transitions */
  transition: font-variation-settings 0.3s cubic-bezier(0.2, 0, 0, 1);

  /* Rendering optimizations */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Arabic Font Override - Maintains variable settings where possible, 
   but falls back to Noto Sans Arabic for the family */
html[dir="rtl"] body,
html[lang="ar"] body {
  font-family: var(--font-en), var(--font-ar), -apple-system, BlinkMacSystemFont, "Google Sans Flex", sans-serif;
}

/* Arabic Headings & Active UI - IBM Plex Sans Arabic */
html[dir="rtl"] h1,
html[dir="rtl"] .h1,
html[dir="rtl"] h2,
html[dir="rtl"] .h2,
html[dir="rtl"] h3,
html[dir="rtl"] .h3,
html[dir="rtl"] h4,
html[dir="rtl"] .h4,
html[dir="rtl"] h5,
html[dir="rtl"] .h5,
html[dir="rtl"] h6,
html[dir="rtl"] .h6,
html[dir="rtl"] nav,
html[lang="ar"] h1,
html[lang="ar"] .h1,
html[lang="ar"] h2,
html[lang="ar"] .h2,
html[lang="ar"] h3,
html[lang="ar"] .h3,
html[lang="ar"] h4,
html[lang="ar"] .h4,
html[lang="ar"] h5,
html[lang="ar"] .h5,
html[lang="ar"] h6,
html[lang="ar"] .h6,
html[lang="ar"] nav {
  font-family: var(--font-en), var(--font-ar), -apple-system, BlinkMacSystemFont, "Google Sans Flex", sans-serif;
}

/* Adjust padding/height for Arabic Navigation to accommodate font weight/size */
html[dir="rtl"] nav .main-nav-tab,
html[lang="ar"] nav .main-nav-tab {
  padding-top: 0.4rem !important;
  padding-bottom: 0.4rem !important;
  line-height: 1.5 !important;
}

/* --- Contextual Typography Classes --- */

/* 1. Calm: For backgrounds, secondary text, relaxed reading */
.type-calm {
  --font-weight: var(--weight-calm);
  --font-width: var(--width-standard);
  --font-grade: var(--grade-soft);
  /* opsz handled automatically */
}

/* 2. Functional: For data tables, inputs, dense UI */
.type-functional {
  --font-weight: var(--weight-functional);
  --font-width: var(--width-compact);
  --font-grade: var(--grade-neutral);
  /* opsz handled automatically */
}

/* 3. Interactive: For buttons, tabs, links */
.type-interactive {
  --font-weight: var(--weight-medium);
  --font-width: var(--width-standard);
  --font-grade: var(--grade-neutral);
  /* opsz handled automatically */
  cursor: pointer;
}
/* Micro-interaction: Grade shift on hover for "tactile" feel */
.type-interactive:hover {
  --font-grade: 50;
}

/* 4. Expressive: For headlines, hero sections, modal titles */
.type-expressive {
  --font-weight: var(--weight-bold);
  --font-width: var(--width-expressive);
  --font-grade: var(--grade-neutral);
  /* opsz handled automatically */
}

/* --- Automatic Heading Hierarchy --- */
/* We no longer force opsz, browser does it better */
h1,
.h1 {
  --font-weight: 600;
  --font-width: 110;
}
h2,
.h2 {
  --font-weight: 550;
  --font-width: 105;
}
h3,
.h3 {
  --font-weight: 500;
  --font-width: 100;
}

/* Ensure standard bold utilities still work by mapping them if needed, 
   though font-variation-settings usually overrides font-weight.
   We force the variable update for these utility classes. */
.font-bold {
  --font-weight: 700;
}
.font-medium {
  --font-weight: 500;
}
.font-semibold {
  --font-weight: 600;
}
.font-light {
  --font-weight: 300;
}

/* Force Arabic Bold Buttons - IBM Plex Sans Arabic has proper bold weights */
html[dir="rtl"] .font-bold,
html[lang="ar"] .font-bold {
  font-weight: 700 !important;
  font-family: var(--font-en), var(--font-ar), -apple-system, BlinkMacSystemFont, "Google Sans Flex", sans-serif;
}
